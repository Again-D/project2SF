<!DOCTYPE html>
<html
  lang="ko"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/base}">
  <head>
    <title layout:title="대시보드"></title>
    <th:block layout:fragment="css">
      <style>
        /* dashboard.html 고유의 CSS 스타일을 여기에 작성합니다. */
        /* defects.html에서 가져온 테이블 및 이미지 스타일 */
        .defect-image {
          max-width: 100px; /* 테이블 내 이미지 크기 조정 */
          height: auto; /* 비율 유지 */
          display: block; /* 이미지 아래 공백 제거 */
          margin: 0 auto; /* 가운데 정렬 */
        }

        /* 데이터 테이블 스타일 */
        #defect-table,
        #detection-log-table {
          /* 로그 테이블 스타일 추가 */
          width: 100%; /* 테이블 전체 너비 사용 */
          border-collapse: collapse; /* 테이블 셀 경계선 병합 */
          margin-top: 20px;
        }

        #defect-table th,
        #defect-table td,
        #detection-log-table th, /* 로그 테이블 스타일 추가 */
        #detection-log-table td {
          /* 로그 테이블 스타일 추가 */
          border: 1px solid #ddd; /* 셀 경계선 */
          padding: 8px; /* 셀 패딩 */
          text-align: left; /* 텍스트 왼쪽 정렬 */
        }

        #defect-table th,
        #detection-log-table th {
          /* 로그 테이블 스타일 추가 */
          background-color: #f2f2f2; /* 헤더 배경색 */
          font-weight: bold;
        }

        #defect-table tbody tr:nth-child(even),
        #detection-log-table tbody tr:nth-child(even) {
          /* 로그 테이블 스타일 추가 */
          background-color: #f9f9f9; /* 짝수 행 배경색 */
        }

        #defect-table tbody tr:hover,
        #detection-log-table tbody tr:hover {
          /* 로그 테이블 스타일 추가 */
          background-color: #e9e9e9; /* 마우스 오버 시 배경색 */
        }

        /* 불량 정보 로딩/없음/오류 메시지 스타일 */
        #defect-list-container .text-center,
        #detection-log-container .text-center {
          /* 로그 테이블 컨테이너 스타일 추가 */
          text-align: center;
        }
        #defect-list-container .text-gray-500,
        #detection-log-container .text-gray-500 {
          /* 로그 테이블 컨테이너 스타일 추가 */
          color: #6b7280; /* Tailwind gray-500 */
        }
        #defect-list-container .text-red-500,
        #detection-log-container .text-red-500 {
          /* 로그 테이블 컨테이너 스타일 추가 */
          color: #ef4444; /* Tailwind red-500 */
        }

        /* Chart.js 캔버스 컨테이너에 반응형 스타일 적용 */
        /* 캔버스 자체는 부모에 맞게 조절되도록 유지 */
        .chart-container canvas {
          max-width: 100%;
          height: 100%; /* 부모 높이에 꽉 차도록 설정 */
        }

        /* 차트 컨테이너 div에 고정 높이 설정 */
        /* Tailwind 클래스에 직접 스타일 추가 */
        .bg-white.rounded-lg.shadow.p-6 {
          height: 500px; /* 원하는 고정 높이 값으로 조정하세요 */
          /* overflow: hidden; /* 내용이 넘칠 경우 숨김 (필요시) */
        }

        /* 새로운 행 추가 시 애니메이션 (선택 사항) */
        @keyframes fadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }
        .new-row {
          animation: fadeIn 0.5s ease-in-out;
        }
      </style>
    </th:block>
  </head>
  <body>
    <div layout:fragment="content">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="bg-white rounded-lg shadow p-6">
          <h2 class="text-lg font-semibold mb-4">주간 감지 상태 (최근 7일)</h2>
          <canvas id="weekStatusChart"></canvas>
        </div>

        <div class="bg-white rounded-lg shadow p-6">
          <h2 class="text-lg font-semibold mb-4">전체 감지 상태 비율</h2>
          <canvas id="detectionStatusChart"></canvas>
        </div>

        <div class="bg-white rounded-lg shadow p-6">
          <h2 class="text-lg font-semibold mb-4">당일 감지 상태 비율</h2>
          <canvas id="dayStatusChart"></canvas>
        </div>
        <div class="bg-white rounded-lg shadow p-6 col-span-1 md:col-span-2">
          <h2 class="text-lg font-semibold mb-4">
            연간 불량 감지 추이 (최근 12개월)
          </h2>
          <canvas id="yearStatusChart"></canvas>
        </div>
      </div>

      <h2 class="text-2xl font-semibold text-gray-700 mb-4 mt-6">
        감지 결과 로그
      </h2>
      <div id="detection-log-container" class="overflow-x-auto">
        <table id="detection-log-table" class="min-w-full bg-white">
          <thead>
            <tr>
              <th>시간</th>
              <th>상태</th>
              <th>불량 유형 요약</th>
              <th>불량 개수</th>
              <th>이미지</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" class="py-4 px-4 text-center text-gray-500">
                감지 로그 로딩 중...
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <h2 class="text-2xl font-semibold text-gray-700 mb-4 mt-6">
        최신 불량 감지 결과
      </h2>
      <div id="defect-list-container" class="overflow-x-auto">
        <table id="defect-table" class="min-w-full bg-white">
          <thead>
            <tr>
              <th>클래스</th>
              <th>사유</th>
              <th>신뢰도</th>
              <th>위치 (Box)</th>
              <th>면적 비율 (%)</th>
              <th>감지 사진</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="6" class="py-4 px-4 text-center text-gray-500">
                불량 정보 로딩 중...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <th:block layout:fragment="script">
      <script src="/js/dashboard.js"></script>
    </th:block>
  </body>
</html>
