<!DOCTYPE html>
<html
  lang="ko"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/base}"
>
  <head>
    <title layout:title="Control Panel">Control Panel</title>
    <link rel="stylesheet" th:href="@{/css/defects.css}" />
  </head>
  <body>
    <div layout:fragment="content">
      <div class="p-6 bg-gray-100 min-h-screen">
        <h2 class="text-3xl font-bold text-gray-900 mb-8">컨트롤 패널</h2>

        <div class="flex flex-col items-start gap-6">
          <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-lg">
            <h3 class="text-xl font-semibold text-green-700 mb-4 border-b pb-2">
              모듈 상태
            </h3>
            <div class="flex items-center justify-between mb-3">
              <span class="text-gray-700"
                >시스템 상태:
                <span id="check-system-status" class="font-bold text-gray-500"
                  >Now Loading</span
                ></span>
            </div>
            <div class="flex items-center justify-between mb-3">
              <span class="text-gray-700"
                >스크립트 상태:
                <span id="check-script-status" class="font-bold text-gray-500"
                  >Now Loading</span
                ></span>
            </div>
            <div class="flex items-center justify-between mb-3">
              <span class="text-gray-700"
                >카메라 스트림 상태:
                <span id="stream-status-message" class="stream-status status-loading"
                  >스트림 연결 중...</span
                ></span>
            </div>
          </div>

          <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-lg">
            <h3 class="text-xl font-semibold text-green-700 mb-4 border-b pb-2">
              스크립트 제어
            </h3>
            <div class="flex items-center justify-between mb-3">
              <p class="text-gray-700 ">
                현재 상태: <span id="script-status" class="font-bold text-gray-500">로딩 중...</span>
              </p>
            </div>
            <div class="space-y-3">
              <button
                id="start-script-btn"
                class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-2">
                스크립트 시작
              </button>
              <button
                id="stop-script-btn"
                class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                스크립트 중지
              </button>
            </div>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-lg">
            <h3 class="text-xl font-semibold text-green-700 mb-4 border-b pb-2">
              시스템 제어
            </h3>
            <div class="flex items-center justify-between mb-3">
              <span class="text-gray-700"
                >현재 상태:
                <span id="system-status" class="font-bold text-gray-500"
                  >Now Loading</span
                ></span
              >
            </div>
            <div class="space-y-3">
              <button
                id="btn-start"
                class="w-full flex items-center justify-center gap-2 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-md transition"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
                시작
              </button>

              <button
                id="btn-stop"
                class="w-full flex items-center justify-center gap-2 bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-md transition"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                </svg>
                중지
              </button>
            </div>
          </div>

        <div class="flex flex-col items-start gap-6">
          <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-lg" style="display:none">
            <h3 class="text-xl font-semibold text-green-700 mb-4 border-b pb-2">
              센서
            </h3>
            <div class="flex items-center justify-between mb-3">
              <span class="text-gray-700"
                >상태:
                <span id="sensor-status" class="font-bold text-gray-500"
                  >OFF</span
                ></span
              >
            </div>
            <div class="grid grid-cols-2 gap-3">
              <button
                id="btn-sensor-on"
                data-target="sensor"
                data-action="on"
                class="toggle-button flex items-center justify-center gap-2 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-md transition"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M18.36 6.64a9 9 0 1 1-12.73 0"></path>
                  <line x1="12" y1="2" x2="12" y2="12"></line>
                </svg>
                ON
              </button>
              <button
                id="btn-sensor-off"
                data-target="sensor"
                data-action="off"
                class="toggle-button flex items-center justify-center gap-2 bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-md transition"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M18.36 6.64a9 9 0 1 1-12.73 0"></path>
                  <line x1="12" y1="2" x2="12" y2="12"></line>
                  <line x1="4.93" y1="4.93" x2="2" y2="2"></line>
                  <line x1="19.07" y1="4.93" x2="22" y2="2"></line>
                  <line x1="4.93" y1="19.07" x2="2" y2="22"></line>
                  <line x1="19.07" y1="19.07" x2="22" y2="22"></line>
                </svg>
                OFF
              </button>
            </div>
          </div>

          <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-lg" style="display:none">
            <h3 class="text-xl font-semibold text-green-700 mb-4 border-b pb-2">
              부저
            </h3>
            <div class="flex items-center justify-between mb-3">
              <span class="text-gray-700"
                >상태:
                <span id="buzzer-status" class="font-bold text-gray-500"
                  >OFF</span
                ></span
              >
            </div>
            <div class="grid grid-cols-2 gap-3">
              <button
                id="btn-buzzer-on"
                data-target="buzzer"
                data-action="on"
                class="toggle-button flex items-center justify-center gap-2 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-md transition"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M12 22c1.1 0 2-.9 2-2v-1H10v1c0 1.1.9 2 2 2z"></path>
                  <path
                    d="M10.3 2.25A7.5 7.5 0 0 0 4.5 9.5c0 4.5 3 8.5 3 8.5h9c0 0 3-4 3-8.5a7.5 7.5 0 0 0-5.8-7.25"
                  ></path>
                </svg>
                ON
              </button>
              <button
                id="btn-buzzer-off"
                data-target="buzzer"
                data-action="off"
                class="toggle-button flex items-center justify-center gap-2 bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-md transition"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M12 22c1.1 0 2-.9 2-2v-1H10v1c0 1.1.9 2 2 2z"></path>
                  <path
                    d="M10.3 2.25A7.5 7.5 0 0 0 4.5 9.5c0 4.5 3 8.5 3 8.5h9c0 0 3-4 3-8.5a7.5 7.5 0 0 0-5.8-7.25"
                  ></path>
                  <line x1="1" y1="1" x2="23" y2="23"></line>
                </svg>
                OFF
              </button>
            </div>
          </div>
        </div>

        <h2 class="text-2xl font-semibold text-gray-700 mb-4 mt-6">
          제어 결과 로그
        </h2>
        <div class="control-log-scroll-container info-card">
          <div id="control-log-container" class="overflow-x-auto">
            <table id="control-log-table" class="min-w-full bg-white">
              <thead>
                <tr>
                  <th class="py-2 px-4 border-b text-left">시간</th>
                  <th class="py-2 px-4 border-b text-left">유형</th>
                  <th class="py-2 px-4 border-b text-left">제어 내용</th>
                  <th class="py-2 px-4 border-b text-left">결과</th>
                  <th class="py-2 px-4 border-b text-center">비고</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="5" class="py-4 px-4 text-center text-gray-500">
                    제어 로그 로딩 중...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

      

    <th:block layout:fragment="script">
      <script th:src="@{/js/controllog.js}"></script>
      <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
    </th:block>
  </body>
</html>
