<!DOCTYPE html>
<html
  lang="ko"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/base}">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title layout:title="불량 감지 결과"></title>
    <link rel="stylesheet" th:href="@{/css/defects.css}" />
  </head>
  <body>
    <div layout:fragment="content">
      <h2 class="text-2xl font-semibold text-gray-700 mb-4">감지 화면</h2>
      <div class="card">
        <img
          id="mjpeg-stream-img"
          src="http://localhost:8080"
          alt="MJPEG Stream"
          style="width: 640px; height: 480px; display: block; margin: 0 auto" />
        <p id="stream-status-message" class="stream-status status-loading">
          스트림 연결 중...
        </p>
      </div>

      <h2 class="text-2xl font-semibold text-gray-700 mb-4 mt-6">
        스크립트 제어
      </h2>
      <div class="script-control-panel">
        <p>현재 상태: <span id="script-status">로딩 중...</span></p>
        <button id="start-script-btn">스크립트 시작</button>
        <button id="stop-script-btn">스크립트 중지</button>
      </div>

      <h2 class="text-2xl font-semibold text-gray-700 mb-4 mt-6">
        최신 불량 감지 결과
      </h2>
      <div id="defect-list-container" class="overflow-x-auto">
        <table id="defect-table" class="min-w-full bg-white">
          <thead>
            <tr>
              <th>클래스</th>
              <th>사유</th>
              <th>신뢰도</th>
              <th>위치 (Box)</th>
              <th>면적 비율 (%)</th>
              <th>감지 사진</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="6" class="py-4 px-4 text-center text-gray-500">
                불량 정보 로딩 중...
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <h2 class="text-2xl font-semibold text-gray-700 mb-4 mt-6">
        감지 결과 로그
      </h2>
      <div id="detection-log-container" class="overflow-x-auto">
        <table id="detection-log-table" class="min-w-full bg-white">
          <thead>
            <tr>
              <th>시간</th>
              <th>상태</th>
              <th>불량 유형 요약</th>
              <th>불량 개수</th>
              <th>이미지</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" class="py-4 px-4 text-center text-gray-500">
                감지 로그 로딩 중...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <th:block layout:fragment="script">
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script src="/js/defects.js"></script>
    </th:block>
  </body>
</html>
